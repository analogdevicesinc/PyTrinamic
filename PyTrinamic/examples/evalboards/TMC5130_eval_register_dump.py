'''
Created on 09.01.2019

@author: LK
'''

if __name__ == '__main__':
    pass

import PyTrinamic
from PyTrinamic.connections.serial_tmcl_interface import serial_tmcl_interface
from PyTrinamic.evalboards.TMC5130_eval import TMC5130_eval
from PyTrinamic.ic.TMC5130.TMC5130_register import TMC5130_register
from PyTrinamic.ic.TMC5130.TMC5130_mask_shift import TMC5130_mask_shift

PyTrinamic.showInfo()
PyTrinamic.showAvailableComPorts()

myInterface = serial_tmcl_interface('COM3')
tmc5130_eval = TMC5130_eval(myInterface)
tmc5130_eval.showChipInfo()

tmc5130_reg = TMC5130_register()
tmc5130_ms = TMC5130_mask_shift()

print("GCONF: ")
print(myInterface.readMC(tmc5130_reg.GCONF).value)
print("GSTAT: ")
print(myInterface.readMC(tmc5130_reg.GSTAT).value)
print("IFCNT: ")
print(myInterface.readMC(tmc5130_reg.IFCNT).value)
print("SLAVECONF: ")
print(myInterface.readMC(tmc5130_reg.SLAVECONF).value)
print("INP_OUT: ")
print(myInterface.readMC(tmc5130_reg.INP_OUT).value)
print("X_COMPARE: ")
print(myInterface.readMC(tmc5130_reg.X_COMPARE).value)
print("IHOLD_IRUN: ")
print(myInterface.readMC(tmc5130_reg.IHOLD_IRUN).value)
print("TPOWERDOWN: ")
print(myInterface.readMC(tmc5130_reg.TPOWERDOWN).value)
print("TSTEP: ")
print(myInterface.readMC(tmc5130_reg.TSTEP).value)
print("TPWMTHRS: ")
print(myInterface.readMC(tmc5130_reg.TPWMTHRS).value)
print("TCOOLTHRS: ")
print(myInterface.readMC(tmc5130_reg.TCOOLTHRS).value)
print("THIGH: ")
print(myInterface.readMC(tmc5130_reg.THIGH).value)
print("RAMPMODE: ")
print(myInterface.readMC(tmc5130_reg.RAMPMODE).value)
print("XACTUAL: ")
print(myInterface.readMC(tmc5130_reg.XACTUAL).value)
print("VACTUAL: ")
print(myInterface.readMC(tmc5130_reg.VACTUAL).value)
print("VSTART: ")
print(myInterface.readMC(tmc5130_reg.VSTART).value)
print("A1: ")
print(myInterface.readMC(tmc5130_reg.A1).value)
print("V1: ")
print(myInterface.readMC(tmc5130_reg.V1).value)
print("AMAX: ")
print(myInterface.readMC(tmc5130_reg.AMAX).value)
print("VMAX: ")
print(myInterface.readMC(tmc5130_reg.VMAX).value)
print("DMAX: ")
print(myInterface.readMC(tmc5130_reg.DMAX).value)
print("D1: ")
print(myInterface.readMC(tmc5130_reg.D1).value)
print("VSTOP: ")
print(myInterface.readMC(tmc5130_reg.VSTOP).value)
print("TZEROWAIT: ")
print(myInterface.readMC(tmc5130_reg.TZEROWAIT).value)
print("XTARGET: ")
print(myInterface.readMC(tmc5130_reg.XTARGET).value)
print("VDCMIN: ")
print(myInterface.readMC(tmc5130_reg.VDCMIN).value)
print("SWMODE: ")
print(myInterface.readMC(tmc5130_reg.SWMODE).value)
print("RAMPSTAT: ")
print(myInterface.readMC(tmc5130_reg.RAMPSTAT).value)
print("XLATCH: ")
print(myInterface.readMC(tmc5130_reg.XLATCH).value)
print("ENCMODE: ")
print(myInterface.readMC(tmc5130_reg.ENCMODE).value)
print("XENC: ")
print(myInterface.readMC(tmc5130_reg.XENC).value)
print("ENC_CONST: ")
print(myInterface.readMC(tmc5130_reg.ENC_CONST).value)
print("ENC_STATUS: ")
print(myInterface.readMC(tmc5130_reg.ENC_STATUS).value)
print("ENC_LATCH: ")
print(myInterface.readMC(tmc5130_reg.ENC_LATCH).value)
print("MSLUT0: ")
print(myInterface.readMC(tmc5130_reg.MSLUT0).value)
print("MSLUT1: ")
print(myInterface.readMC(tmc5130_reg.MSLUT1).value)
print("MSLUT2: ")
print(myInterface.readMC(tmc5130_reg.MSLUT2).value)
print("MSLUT3: ")
print(myInterface.readMC(tmc5130_reg.MSLUT3).value)
print("MSLUT4: ")
print(myInterface.readMC(tmc5130_reg.MSLUT4).value)
print("MSLUT5: ")
print(myInterface.readMC(tmc5130_reg.MSLUT5).value)
print("MSLUT6: ")
print(myInterface.readMC(tmc5130_reg.MSLUT6).value)
print("MSLUT7: ")
print(myInterface.readMC(tmc5130_reg.MSLUT7).value)
print("MSLUTSEL: ")
print(myInterface.readMC(tmc5130_reg.MSLUTSEL).value)
print("MSLUTSTART: ")
print(myInterface.readMC(tmc5130_reg.MSLUTSTART).value)
print("MSCNT: ")
print(myInterface.readMC(tmc5130_reg.MSCNT).value)
print("MSCURACT: ")
print(myInterface.readMC(tmc5130_reg.MSCURACT).value)
print("CHOPCONF: ")
print(myInterface.readMC(tmc5130_reg.CHOPCONF).value)
print("COOLCONF: ")
print(myInterface.readMC(tmc5130_reg.COOLCONF).value)
print("DCCTRL: ")
print(myInterface.readMC(tmc5130_reg.DCCTRL).value)
print("DRVSTATUS: ")
print(myInterface.readMC(tmc5130_reg.DRVSTATUS).value)
print("PWMCONF: ")
print(myInterface.readMC(tmc5130_reg.PWMCONF).value)
print("PWMSTATUS: ")
print(myInterface.readMC(tmc5130_reg.PWMSTATUS).value)
print("ENCM_CTRL: ")
print(myInterface.readMC(tmc5130_reg.ENCM_CTRL).value)
print("LOST_STEPS: ")
print(myInterface.readMC(tmc5130_reg.LOST_STEPS).value)

#" unpower "
#print("unpowered...")
#myInterface.writeMC(tmc4672_reg.UQ_UD_EXT, 0)

myInterface.close()